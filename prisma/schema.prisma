datasource db {
  provider = "postgresql"  
  url      = env("POSTGRES_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
id Int @id @default(autoincrement())

fullName String
email String @unique
password String
role UserRole @default(USER)

cart Cart?
oder Order[]
verificationCode VerificationCode?

provider String?
providerId String?

createAt DateTime @default(now())
updateAt DateTime @updatedAt
}

model Category {
  id Int @id @default(autoincrement())
  name String @unique
  products Product[]

  createAt DateTime @default(now())
updateAt DateTime @updatedAt
}

model Product {
  id Int @id @default(autoincrement()) 
  name String
  imageURL String

category Category @relation(fields: [categoryId], references: [id])
categoryId Int

poductVariations PoductVariations[]
ingredient Ingredient[]

createAt DateTime @default(now())
updateAt DateTime @updatedAt

}

model Ingredient {
id Int @id @default(autoincrement())

name String
price Int
imageUrl String

product Product[]
items CardItem[]

createAt DateTime @default(now())
updateAt DateTime @updatedAt
}

model PoductVariations {
id Int @id @default(autoincrement())

price Int
size Int?
pizzaDoughType Int?

items CardItem[]

product Product  @relation(fields: [productId], references: [id])
productId Int

createAt DateTime @default(now())
updateAt DateTime @updatedAt
}


model Cart {
id Int @id @default(autoincrement())

user User? @relation(fields: [userId], references: [id])
userId Int @unique

items CardItem[]


totalAmount Int @default(0)

token String

createAt DateTime @default(now())
updateAt DateTime @updatedAt
}


model CardItem {
id Int @id @default(autoincrement())


cart Cart @relation(fields: [cardId], references: [id])
cardId Int

poductVariations PoductVariations  @relation(fields: [poductVariationsId], references: [id])
poductVariationsId Int



ingredients Ingredient[]

quantity Int

createAt DateTime @default(now())
updateAt DateTime @updatedAt
}

model Order {
id Int @id @default(autoincrement())

user User? @relation(fields: [userId], references: [id])
userId Int?

token String
totalAmount String
status OrderStatus
paymentId String?

items Json

fullName String
address String
email String
phone String
comment String?

createAt DateTime @default(now())
updateAt DateTime @updatedAt
}

model VerificationCode{
id Int @id @default(autoincrement())

user User @relation(fields: [userId], references: [id])
userId Int @unique

code String

createAt DateTime @default(now())
}

enum OrderStatus{
  PENDING
  SUCCEEDED
  CANCELLED
}

enum UserRole {
  ADMIN
  USER
}